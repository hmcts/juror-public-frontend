{% extends "../../layouts/default.njk" %}

{% block page_title %}
  {% if user.thirdParty == 'Yes' %}
  {{ texts.DEFERRAL_PAGE.HEADING_OB }} - {{ texts.INTERFACE.GOV }}
  {% else %}
  {{ texts.DEFERRAL_PAGE.HEADING }} - {{ texts.INTERFACE.GOV }}
  {% endif %}
{% endblock %}

{% block page_identifier %}Deferral Dates{% endblock %}

{% block content %}

<div class="grid-row">

  <div class="column-two-thirds">

    <h1 class="heading-xlarge">
      {% if user.thirdParty == 'Yes' %}
      {{ texts.DEFERRAL_PAGE.HEADING_OB }}
      {% else %}
      {{ texts.DEFERRAL_PAGE.HEADING }}
      {% endif %}
    </h1>

    {% include "../../includes/errors.njk" %}

    <form action="{{ url('steps.confirm.date.deferral-dates.post') }}" method="post" {% if not IS_PRODUCTION %}novalidate{% endif %}>

      <strong class="bold-small">
        {% if user.thirdParty == 'Yes' %}
        {{ texts.DEFERRAL_PAGE.DATE_FIELD_TITLE_OB }}
        {% else %}
        {{ texts.DEFERRAL_PAGE.DATE_FIELD_TITLE }}
        {% endif %}
      </strong>
      <span class="form-hint">{{ texts.DEFERRAL_PAGE.DATE_FIELD_HINT }}</span>

      <br />

      <div class="form-group">
        <details>
          <summary {% if trackingCode %}onclick="trackVirtualPageViews('Why do we ask this?')"{% endif %}>{{ texts.DEFERRAL_PAGE.WHY_ASK_SUMMARY }}</summary>
          <div class="panel panel-border-narrow" id="details-content-1" aria-hidden="true">
            <p>
              {% if user.thirdParty == 'Yes' %}
              {{ texts.DEFERRAL_PAGE.WHY_ASK_INFO_OB }}
              {% else %}
              {{ texts.DEFERRAL_PAGE.WHY_ASK_INFO }}
              {% endif %}
            </p>
          </div>
        </details>
      </div>
      <br />
      <br />

      <div class="form-group box-grey {% if errors.items['deferralDates'] %}error{% endif %}" id="deferralDatesGroup">
        <strong class="bold-small">
          {% if user.thirdParty == 'Yes' %}
          {{ texts.DEFERRAL_PAGE.DATE_INFO_OB }}
          {% else %}
          {{ texts.DEFERRAL_PAGE.DATE_INFO }}
          {% endif %}
        </strong>
        <br />
        <br />

        {% if errors.items['deferralDates'] %}
        <span class="error-message">
          {{ errors.items['deferralDatres'][0].details }}
        </span>
        {% endif %}
        <div class="grid-row">

          <div class="column-one-third">
            <div class="{% if errors.items['date1'] %}error{% endif %}">
              <label class="form-label" for="date1">
                <strong class="bold-small">
                  {{ texts.DEFERRAL_PAGE.DATE1 }}
                </strong>
              </label>
              <div>
                <input class="form-control fill" name="date1" id="date1" type="text" value="{{ user.date1 }}" />
                <button id="btn_date1" class="calendar-button noscript"><img src="{{ assetPath }}img/icons/icon-calendar.png" alt="open clendar" /></button>


                <div id="dp1" class="datepicker" aria-hidden="true">
                  <div id="month-wrap">
                    <div id="bn_prev" role="button" aria-labelledby="bn_prev-label" tabindex="0">
                      {# <img class="bn_img" src="prev.png" alt="<<"/> #}
                      <span>&lt;</span>
                    </div>
                    <div id="month" role="heading" aria-live="assertive" aria-atomic="true"></div>
                    <div id="bn_next" role="button" aria-labelledby="bn_next-label" tabindex="0">
                      {# <img class="bn_img" src="next.png" alt=">>"/> #}
                      <span>&gt;</span>
                    </div>
                  </div>
                  <table id="cal" role="grid" aria-activedescendant="errMsg" aria-labelledby="month" tabindex="0">
                    <thead>
                        <tr id="weekdays">
                          <th id="Sunday"><abbr title="Sunday">Su</abbr></th>
                          <th id="Monday"><abbr title="Monday">Mo</abbr></th>
                          <th id="Tuesday"><abbr title="Tuesday">Tu</abbr></th>
                          <th id="Wednesday"><abbr title="Wednesday">We</abbr></th>
                          <th id="Thursday"><abbr title="Thursday">Th</abbr></th>
                          <th id="Friday"><abbr title="Friday">Fr</abbr></th>
                          <th id="Saturday"><abbr title="Saturday">Sa</abbr></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td id="errMsg" colspan="7">Javascript must be enabled</td></tr>
                    </tbody>
                  </table>
                  <div id="bn_prev-label" class="offscreen">Go to previous month</div>
                  <div id="bn_next-label" class="offscreen">Go to next month</div>
                </div>

              </div>

              <span class="form-hint">{{ texts.DEFERRAL_PAGE.DATE_EG }}</span>
            </div>
          </div>

          <div class="column-one-third">
            <div class="{% if errors.items['date1'] %}error{% endif %}">
              <label class="form-label" for="date2">
                <strong class="bold-small">
                  {{ texts.DEFERRAL_PAGE.DATE2 }}
                </strong>
              </label>
              <input class="form-control fill" name="date2" id="date2" type="text" value="{{ user.date2 }}" />
              <button id="btn_date2" class="calendar-button noscript"><img src="{{ assetPath }}img/icons/icon-calendar.png" alt="open clendar" /></button>

              <div id="dp2" class="datepicker" aria-hidden="true">
                <div id="month-wrap">
                  <div id="bn_prev" role="button" aria-labelledby="bn_prev-label" tabindex="0">
                    {# <img class="bn_img" src="prev.png" alt="<<"/> #}
                    <span class="bn_img">&lt;</span>
                  </div>
                  <div id="month" role="heading" aria-live="assertive" aria-atomic="true"></div>
                  <div id="bn_next" role="button" aria-labelledby="bn_next-label" tabindex="0">
                    {# <img class="bn_img" src="next.png" alt=">>"/> #}
                    <span class="bn_img">&gt;</span>
                  </div>
                </div>
                <table id="cal" role="grid" aria-activedescendant="errMsg" aria-labelledby="month" tabindex="0">
                  <thead>
                      <tr id="weekdays">
                        <th id="Sunday"><abbr title="Sunday">Su</abbr></th>
                        <th id="Monday"><abbr title="Monday">Mo</abbr></th>
                        <th id="Tuesday"><abbr title="Tuesday">Tu</abbr></th>
                        <th id="Wednesday"><abbr title="Wednesday">We</abbr></th>
                        <th id="Thursday"><abbr title="Thursday">Th</abbr></th>
                        <th id="Friday"><abbr title="Friday">Fr</abbr></th>
                        <th id="Saturday"><abbr title="Saturday">Sa</abbr></th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr><td id="errMsg" colspan="7">Javascript must be enabled</td></tr>
                  </tbody>
                </table>
                <div id="bn_prev-label" class="offscreen">Go to previous month</div>
                <div id="bn_next-label" class="offscreen">Go to next month</div>
              </div>

              <span class="form-hint">{{ texts.DEFERRAL_PAGE.DATE_EG }}</span>
            </div>
          </div>

          <div class="column-one-third">
            <div class="{% if errors.items['date1'] %}error{% endif %}">
              <label class="form-label" for="date3">
                <strong class="bold-small">
                  {{ texts.DEFERRAL_PAGE.DATE3 }}
                </strong>
              </label>
              <input class="form-control fill" name="date3" id="date3" type="text" value="{{ user.date3 }}" />
              <button id="btn_date3" class="calendar-button noscript"><img src="{{ assetPath }}img/icons/icon-calendar.png" alt="open clendar" /></button>

              <div id="dp3" class="datepicker" aria-hidden="true">
                <div id="month-wrap">
                  <div id="bn_prev" role="button" aria-labelledby="bn_prev-label" tabindex="0">
                    {# <img class="bn_img" src="prev.png" alt="<<"/> #}
                    <span class="bn_img">&lt;</span>
                  </div>
                  <div id="month" role="heading" aria-live="assertive" aria-atomic="true"></div>
                  <div id="bn_next" role="button" aria-labelledby="bn_next-label" tabindex="0">
                    {# <img class="bn_img" src="next.png" alt=">>"/> #}
                    <span class="bn_img">&gt;</span>
                  </div>
                </div>
                <table id="cal" role="grid" aria-activedescendant="errMsg" aria-labelledby="month" tabindex="0">
                  <thead>
                      <tr id="weekdays">
                        <th id="Sunday"><abbr title="Sunday">Su</abbr></th>
                        <th id="Monday"><abbr title="Monday">Mo</abbr></th>
                        <th id="Tuesday"><abbr title="Tuesday">Tu</abbr></th>
                        <th id="Wednesday"><abbr title="Wednesday">We</abbr></th>
                        <th id="Thursday"><abbr title="Thursday">Th</abbr></th>
                        <th id="Friday"><abbr title="Friday">Fr</abbr></th>
                        <th id="Saturday"><abbr title="Saturday">Sa</abbr></th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr><td id="errMsg" colspan="7">Javascript must be enabled</td></tr>
                  </tbody>
                </table>
                <div id="bn_prev-label" class="offscreen">Go to previous month</div>
                <div id="bn_next-label" class="offscreen">Go to next month</div>
              </div>

              <span class="form-hint">{{ texts.DEFERRAL_PAGE.DATE_EG }}</span>
            </div>
          </div>

        </div>

      </div>

      <br />
      <br />
      <br />
      {# Submit form #}
      <input type="hidden" name="_csrf" value="{{ csrftoken }}">
      <input class="button" type="submit" value="{{ texts.INTERFACE.BUTTON_TEXT_CONTINUE }}">
    </form>

  </div>


</div>


{% endblock %}

{% block body_end %}
  {% include "../../includes/scripts.njk" %}
  <script type="text/javascript" src="{{ assetPath }}js/datepicker.js"></script>
  <script type="text/javascript">
    $(document).ready(function(){
      var dp1 = new calendar.datepicker('dp1', 'date1', true);
      var dp2 = new calendar.datepicker('dp2', 'date2', true);
      var dp3 = new calendar.datepicker('dp3', 'date3', true);

      $('#btn_date1').removeClass('noscript').click(function(e) {
        dp1.showDlg();
        e.stopPropagation();
        return false;
      });

      $('#btn_date2').removeClass('noscript').click(function(e) {
        dp2.showDlg();
        e.stopPropagation();
        return false;
      });

      $('#btn_date3').removeClass('noscript').click(function(e) {
        dp3.showDlg();
        e.stopPropagation();
        return false;
      });

    });
  </script>
  {# <link rel="stylesheet" href="{{ assetPath }}css/bootstrap.min.css" media="screen">
  <link rel="stylesheet" href="{{ assetPath }}css/datepicker.css" type="text/css">
  <script type="text/javascript" src="{{ assetPath }}js/locales/en-GB.min.js"></script>
  <script type="text/javascript" src="{{ assetPath }}js/datepicker.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('#date1').datepicker({
        theme: 'bootstrap',
        inputFormat: ["dd/MM/yyyy"],
        outputFormat: 'dd/MM/yyyy',
      });
    });

  </script> #}
{% endblock %}
